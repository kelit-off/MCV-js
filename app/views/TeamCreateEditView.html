<div class="min-h-screen bg-gray-100 flex flex-col">
            <!-- Header -->
            <header class="bg-gradient-to-r from-red-600 to-yellow-500 p-6 shadow-lg">
                <h1 class="text-4xl font-bold text-white text-center">Créer une nouvelle équipe</h1>
                <p class="text-white text-center mt-2">Ajoutez une équipe GT3 ou GT4 dans la base de données</p>
            </header>

            <!-- Main content -->
            <main class="flex-grow max-w-2xl mx-auto p-6">
                <form action="/api/team" data-method="POST" method="POST" class="bg-white p-6 rounded-lg shadow-md space-y-4">
                    <input type="hidden" name="_id" value="${_id}" />
                    <div>
                        <label class="block text-gray-700 mb-1 font-semibold" for="name">Nom de l'équipe</label>
                        <input type="text" id="name" name="name" required value="${name}"
                            class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div> 

                    <div>
                        <label class="block text-gray-700 mb-1 font-semibold" for="category">Catégorie</label>
                        <select id="category" name="category" required
                        class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                            <option value="">Sélectionner une catégorie</option>
                            <option value="gt3" ${selected_gt3}>GT3</option>
                            <option value="gt4" ${selected_gt4}>GT4</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-gray-700 mb-1 font-semibold" for="carSelect">Voiture</label>
                        <input type="hidden" name="_carSelected" value="${carSelected}">
                        <select id="carSelect" name="car" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500" required>
                            <option value="">Sélectionner une voiture</option>
                        </select>
                    </div>

                    <p id="message"></p>

                    <button type="submit" class="px-6 py-2 bg-green-500 text-white font-semibold rounded hover:bg-green-600 transition">
                        Enregistrer l'équipe
                    </button>

                </form>

                <div class="mt-6 text-center">
                    <a id="lienBack" href="/team/${category}" class="text-blue-500 hover:underline">← Retour à la liste des équipes</a>
                </div>
            </main>

            <!-- Footer -->
            <footer class="bg-gray-800 text-white p-6 text-center">
                &copy; 2025 Sport Automobile - Tous droits réservés
            </footer>
        </div>

        <script>
document.addEventListener("DOMContentLoaded", () => {
    const params = new URLSearchParams(window.location.search);
    const categoryParam = params.get("category");
    if (categoryParam) {
        const select = document.querySelector("#category");
        if (select) select.value = categoryParam;
        const lienBack = document.querySelector("#lienBack");
        if(lienBack) lienBack.href = `/team/${categoryParam}`;
    }

    fetch("/api/car")
        .then(res => res.json())
        .then(({ success, cars }) => {
            console.log(cars);
            const select = document.querySelector("#carSelect");

            cars.forEach(car => {
                const option = document.createElement("option");
                option.value = car._id;
                option.textContent =
                    `${car.manufacturer} ${car.name} (${car.category.toUpperCase()})`;

                select.appendChild(option);
            });
        });
});
</script>
<script src="/js/submit.js" defer></script>
