<div class="min-h-screen bg-gray-100 flex flex-col">
    <!-- Header -->
    <header class="bg-gradient-to-r from-red-600 to-yellow-500 p-6 shadow-lg">
        <h1 class="text-4xl font-bold text-white text-center">Ajouter une nouvelle voiture</h1>
        <p class="text-white text-center mt-2">Ajoutez une voiture GT3 ou GT4 dans la base de données</p>
    </header>

    <!-- Main content -->
    <main class="flex-grow max-w-2xl mx-auto p-6">
        <form action="/api/car" data-method="{{car ? 'PUT' : 'POST'}}" class="bg-white p-6 rounded-lg shadow-md space-y-4">
            <input type="hidden" name="_category" value="${_id || ''}">
            <div>
                <label class="block text-gray-700 mb-1 font-semibold" for="name">Nom de la voiture</label>
                <input type="text" id="name" name="name" required value="${name || ''}"
                    class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
            </div> 

            <div>
                <label class="block text-gray-700 mb-1 font-semibold" for="manufacturer">Marque</label>
                <input type="text" id="manufacturer" name="manufacturer" required value="${manufacturer || ''}"
                    class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
            </div>

            <div>
                <label class="block text-gray-700 mb-1 font-semibold" for="category">Catégorie</label>
                <select id="category" name="category" required
                    class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                    <option value="">Sélectionner une catégorie</option>
                    <option value="gt3" ${
                        category === "gt3" ? "selected" : ""
                    }>GT3</option>
                    <option value="gt4" ${
                        category === "gt4" ? "selected" : ""
                    }>GT4</option>
                </select>
            </div>

            <div>
                <label class="block text-gray-700 mb-1 font-semibold" for="year">Année</label>
                <input type="number" id="year" name="year" required value="${year || ''}"
                    class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
            </div>

            <p id="message"></p>

            <button type="submit" class="px-6 py-2 bg-green-500 text-white font-semibold rounded hover:bg-green-600 transition">
                Ajouter la voiture
            </button>

        </form>

        <div class="mt-6 text-center">
            <a id="lienBack" href="/car" class="text-blue-500 hover:underline">← Retour à la liste des voitures</a>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white p-6 text-center">
        &copy; 2025 Sport Automobile - Tous droits réservés
    </footer>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const params = new URLSearchParams(window.location.search);
    const categoryParam = params.get("category");
    if (categoryParam) {
        const select = document.querySelector("#category");
        if (select) select.value = categoryParam;
        const lienBack = document.querySelector("#lienBack");
        if(lienBack) lienBack.href = `/car/${categoryParam}`;
    }
});
</script>
<script src="/js/submit.js" defer></script>
